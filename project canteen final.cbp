#include <stdio.h>
#include <stdlib.h>
#include<conio.h>
#include<time.h>


int token;
void bill_calculator(int a,int count,int *b,int *q)
{
    int i,bill=0 ,t ;
    printf("\nBill Summary:\n");
    if(a==1)
    {
        for(i=0;i<count;i++)
        {
            switch(b[i])
{
    case 1:
        printf("(%d) Poha\tQuantity : %d \tPrice : 20rs.\n",i+1,q[i]);
        bill=bill+(20*q[i]);
    break;
     case 2:
        printf("(%d) Upma\tQuantity : %d\tPrice : 15rs.\n",i+1,q[i]);
        bill=bill+(15*q[i]);
    break;
    case 3:
        printf("(%d) Thepla\tQuantity : %d\tPrice : 30rs.\n",i+1,q[i]);
        bill=bill+(30*q[i]);
    break;
    case 4:
        printf("(%d) Gaathia\tQuantity:%d\tPrice:20rs.\n",i+1,q[i]);
        bill=bill+(20*q[i]);
    break;
    case 5:
        printf("(%d) Idli\tQuantity:%d\tPrice:10rs.\n",i+1,q[i]);
        bill=bill+(10*q[i]);
    break;
    case 6:
        printf("(%d) Wada\tQuantity:%d\tPrice:12rs.\n",i+1,q[i]);
        bill=bill+(12*q[i]);
    break;
    case 7:
        printf("(%d) Sada Dosa\tQuantity:%d\tPrice:22rs.\n",i+1,q[i]);
        bill=bill+(22*q[i]);
    break;
    case 8:
        printf("(%d) Masala Dosa\tQuantity:%d\tPrice:25rs.\n",i+1,q[i]);
        bill=bill+(25*q[i]);
    break;
    case 9:
        printf("(%d) Mysore Masala Dosa\tQuantity:%d\tPrice:30rs.\n",i+1,q[i]);
        bill=bill+(30*q[i]);
    break;
    case 10:
        printf("(%d) Mysore Sada Dosa\tQuantity:%d\tPrice:30rs.\n",i+1,q[i]);
        bill=bill+(30*q[i]);
    break;
    case 11:
        printf("(%d) Cheese Dosa\tQuantity:%d\tPrice:35rs.\n",i+1,q[i]);
        bill=bill+(35*q[i]);
    break;
    case 12:
        printf("(%d) Jain Sandwich\tQuantity:%d\tPrice:30rs.\n",i+1,q[i]);
        bill=bill+(30*q[i]);
    break;
    case 13:
        printf("(%d) Cheese Sandwich\tQuantity:%d\tPrice:25rs.\n",i+1,q[i]);
        bill=bill+(25*q[i]);
    break;
    case 14:
        printf("(%d) Grilled Cheese Sandwich\tQuantity:%d\tPrice:50rs.\n",i+1,q[i]);
        bill=bill+(50*q[i]);
    break;
    case 15:
        printf("(%d) Grilled Vegetable Sandwich\tQuantity:%d\tPrice:40rs.\n",i+1,q[i]);
        bill=bill+(40*q[i]);
    break;
    case 16:
        printf("(%d) Bhel\tQuantity:%d\tPrice:22rs.\n",i+1,q[i]);
        bill=bill+(22*q[i]);
    break;
    case 17:
        printf("(%d) Pani Puri\tQuantity:%d\tPrice:20rs.\n",i+1,q[i]);
        bill=bill+(20*q[i]);
    break;
    case 18:
        printf("(%d) Samosa\tQuantity:%d\tPrice:22rs.\n",i+1,q[i]);
        bill=bill+(22*q[i]);
    break;
    case 19:
        printf("(%d) Samosa Chat\tQuantity:%d\tPrice:30rs.\n",i+1,q[i]);
        bill=bill+(30*q[i]);
    break;
    case 20:
        printf("(%d) Gujarati Thali\tQuantity:%d\tPrice:70rs.\n",i+1,q[i]);
        bill=bill+(70*q[i]);
    break;
    case 21:
        printf("(%d) Paneer Bhurji\tQuantity:%d\tPrice:50rs.\n",i+1,q[i]);
        bill=bill+(50*q[i]);
    break;
    case 22:
        printf("(%d) Paneer Tikka Masala\tQuantity:%d\tPrice:50rs.\n",i+1,q[i]);
        bill=bill+(50*q[i]);
    break;
    case 23:
        printf("(%d) Paneer Handi\tQuantity:%d\tPrice:50rs.\n",i+1,q[i]);
        bill=bill+(50*q[i]);
    break;
    case 24:
        printf("(%d) Butter nan\tQuantity:%d\tPrice:10rs.\n",i+1,q[i]);
        bill=bill+(10*q[i]);
    break;
    case 25:
        printf("(%d) Plain nan\tQuantity:%d\tPrice:10rs.\n",i+1,q[i]);
        bill=bill+(10*q[i]);
    break;
    case 26:
        printf("(%d) Mixed Veg Masala\tQuantity:%d\tPrice:40rs.\n",i+1,q[i]);
        bill=bill+(40*q[i]);
    break;
    case 27:
        printf("(%d) Veg Jalfreezi\tQuantity:%d\tPrice:40rs.\n",i+1,q[i]);
        bill=bill+(40*q[i]);
    break;
    case 28:
        printf("(%d) Pizza\tQuantity:%d\tPrice:35rs.\n",i+1,q[i]);
        bill=bill+(35*q[i]);
    break;
    case 29:
        printf("(%d) Burger\tQuantity:%d\tPrice:25rs.\n",i+1,q[i]);
        bill=bill+(25*q[i]);
    break;
    case 30:
        printf("(%d) Pav Bhaji\tQuantity:%d\tPrice:30rs.\n",i+1,q[i]);
        bill=bill+(30*q[i]);
    break;
    case 31:
        printf("(%d) Chole Bhature\tQuantity:%d\tPrice:40rs.\n",i+1,q[i]);
        bill=bill+(40*q[i]);
    break;
   }
        }
    }
    else{
        for(i=0;i<count;i++)
        {
            switch(b[i])
            {
            case 1:
                printf("(%d) Coca Cola\tQuantity:%d\tPrice:20\n",i+1,q[i]);
                bill=bill+(q[i]*20);
                break;
            case 2:
                printf("(%d) Thumps Up\tQuantity:%d\tPrice:20\n",i+1,q[i]);
                bill=bill+(q[i]*20);
                break;
            case 3:
                printf("(%d) Sprite\tQuantity:%d\tPrice:20\n",i+1,q[i]);
                bill=bill+(q[i]*20);
                break;
            case 4:
                printf("(%d) Maaza\tQuantity:%d\tPrice:15\n",i+1,q[i]);
                bill=bill+(q[i]*15);
                break;
            case 5:
                printf("(%d) Fanta\tQuantity:%d\tPrice:20\n",i+1,q[i]);
                bill=bill+(q[i]*20);
                break;
            case 6:
                printf("(%d) Kesar Doodh\tQuantity:%d\tPrice:15\n",i+1,q[i]);
                bill=bill+(q[i]*15);
                break;
            case 7:
                printf("(%d) Nestle Chocolate Coffee\tQuantity:%d\tPrice:35\n",i+1,q[i]);
                bill=bill+(q[i]*35);
                break;
            case 8:
                printf("(%d) Nestle Pure Coco\tQuantity:%d\tPrice:40\n",i+1,q[i]);
                bill=bill+(q[i]*40);
                break;
            case 9:
                printf("(%d) Appy Fizz\tQuantity:%d\tPrice:15\n",i+1,q[i]);
                bill=bill+(q[i]*15);
                break;
            case 10:
                printf("(%d) Apple Juice\tQuantity:%d\tPrice:30\n",i+1,q[i]);
                bill=bill+(q[i]*30);
                break;
            case 11:
                printf("(%d) Orange Juice\tQuantity:%d\tPrice:30\n",i+1,q[i]);
                bill=bill+(q[i]*30);
                break;
            case 12:
                printf("(%d) Pineapple Juice\tQuantity:%d\tPrice:30\n",i+1,q[i]);
                bill=bill+(q[i]*30);
                break;
            case 13:
                printf("(%d) Sweet Lemon Juice\tQuantity:%d\tPrice:35\n",i+1,q[i]);
                bill=bill+(q[i]*35);
                break;
            case 14:
                printf("(%d) Choco Milkshake\tQuantity:%d\tPrice:50\n",i+1,q[i]);
                bill=bill+(q[i]*50);
                break;
            case 15:
                printf("(%d) Strawberry Milkshake\tQuantity:%d\tPrice:50\n",i+1,q[i]);
                bill=bill+(q[i]*50);
                break;
            }
        }
    }
    printf(" \n Your bill is : %d  rs\n", bill);
    FILE *f;
    f=fopen("Roll.txt","a");
    fprintf(f,"(%d)",bill);
    fclose(f);
}

void time_slot()
{
    int m;
    time_t currenttime;
    time(&currenttime);

    struct tm*mytime = localtime(&currenttime);



   if((mytime->tm_min+10)<30)
  {
      printf(" your time slot is : %i.%i  to  %i.%i ", mytime->tm_hour,mytime->tm_min+10 , mytime->tm_hour,mytime->tm_min+40);
  }
   else
   {
       printf(" your time slot is : %i.%i  to  %i.%i \n", mytime->tm_hour,mytime->tm_min+10 , mytime->tm_hour+1,mytime->tm_min-20);
   }

}
void main()
{
   time_t  currenttime ;
  time(&currenttime);

  printf(" \t \t NIRMA UNIVERSITY \t \t \n");
  printf(" \t \t %s \t \t \n\n",ctime(&currenttime));

    struct tm*mytime = localtime(&currenttime);
    if((mytime->tm_hour)>18 || ((mytime->tm_hour)>0&&(mytime->tm_hour)<9)||((mytime->tm_wday)==7))
    {
      if((mytime->tm_hour)>0&&(mytime->tm_hour)<9)
        {
           printf(" SORRY , WE ARE CLOSED. \n\n");
           printf(" CANTEEN OPENS AT 9. \n");
           goto execute;
        }
      if((mytime->tm_hour)>18)
        {
            printf(" SORRY , WE ARE CLOSED. \n\n");
            printf(" CANTEEN OPENS TOMORROW AT 9.\n");
            goto execute ;
        }
        if((mytime->tm_wday)==7)
        {
            printf(" \n IT IS SUNDAY ! WE ARE CLOSED TODAY. " );
            goto execute ;
        }
    }
    int a,i,ch,roll;
    char reply;
    FILE *f;
    cabel:
    f=fopen("token.txt","r");
    fscanf(f,"%d",&token);
    fclose(f);
    if(token==501){token=0;}
    printf("Welcome to the Nirma University Canteen\n");
    printf("Enter your Roll No.:");
    scanf("%d",&roll);
    if(token==0){
        f=fopen("Roll.txt","w");
        fprintf(f,"");
        fclose(f);
    }
    f=fopen("Roll.txt","a");
    fprintf(f,"%d-%d-",roll,token);
    fclose(f);
    label:

    printf("Choose:\n1.Food\n2.beverages\n");
    printf("\nEnter your choice: ");
    scanf("%d",&a);
    if(a==1)
    {
        int *b;
        int *q;
        int count=0;
        b=(int*)malloc(50*sizeof(int));
        q=(int*)malloc(50*sizeof(int));
        printf("\nThe menu:\n");
        printf("0.None\n1.Poha(20rs)\n2.Upma(15rs)\n3.Thepla(30rs)\n4.Gaathia(20rs)\n5.Idli(10rs)\n6.Wada(12rs)\n7.Sada Dosa(22rs)\n8.Masala Dosa(25rs)\n9.Mysore Masala Dosa(30rs)\n10.Mysore Sada Dosa(30rs)\n11.Cheese Dosa(35rs)\n12.Jain sandwich(30rs)\n13.Cheese sandwich(25rs)\n14.Grilled cheese sandwich(50rs)\n15.Grilled vegetable sandwich(40rs)\n16.Bhel(22rs)\n17.Panipuri(20rs)\n18.Samosa(22rs)\n19.Samosa chat(30rs)\n20.Gujarati Thali(70rs)\n21.Paneer Bhurji(50rs)\n22.Paneer Tikka Masala(50rs)\n23.Paneer handi(50rs)\n24.Butter nan(10rs/per nan)\n25.Plain nan(10rs/per nan)\n26.Mixed Veg masala(40rs)\n27.Veg jalfreezi(40rs)\n28.Pizza(35rs)\n29.Burger(25rs)\n30.pav bhaji(30rs)\n31.Chole Bhature(40rs)");
        printf("\n \nEnter your food item no. and \n quantity, \n then press 's' to submit:\n");
        for(i=0;i<50;i++)
        {
            char c;
            scanf("%d",&b[i]);
            count++;
            scanf("%d",&q[i]);
            scanf("%c",&c);
            if(c=='s')
                break;
        }
        printf("Press any key to fetch the bill...");
        getch();
        system("cls");
        bill_calculator(a,count,b,q);
        table:
        printf("Do you wish to add order again?('Y' for yes & 'N' for no):\n");
        reply=getch();
        if(reply=='Y')
            {goto label;}
        else if(reply=='N'){
            printf("It will be a pleasure to serve you.\n \n Your Token Number is:%d \n Press any key for further procedure..",token);
            getch();
                f=fopen("token.txt","w");
    ch=token+1;
    fprintf(f,"%d",ch);
    fclose(f);
            system("cls");
           // goto cabel;
    }
    else{printf("Enter a valid input.");
    getch();
    goto table;}
    }
    else if(a==2)
    {
        int *b;
        int *q;
        int count=0;
        b=(int*)malloc(50*sizeof(int));
        q=(int*)malloc(50*sizeof(int));
        printf("\nThe menu:\n");
        printf("1.Coca cola(20rs).\n2.Thumps Up(20rs).\n3.Sprite(20rs).\n4.Maaza(15rs)\n5.Fanta(20)\n6.Kesar Doodh(15rs).\n7.Nestle Chocolate Coffee(35rs).\n8.Nestle Pure Coco(40rs).\n9.Appy Fizz(15rs).\n10.Apple Juice(30rs).\n11.Orange Juice(30rs)\n12.Pineapple Juice(30rs)\n13.Sweet Lemon Juice(35rs)\n14.Choco milkshake(50rs)\n15.Strawberry milkshake(50rs).");
        printf("\nEnter your Beverage item no. and quantity, then press 's' to submit:\n");
        for(i=0;i<50;i++)
        {
            char c;
            scanf("%d",&b[i]);
            count++;
            scanf("%d",&q[i]);
            scanf("%c",&c);
            if(c=='s')
                break;
        }
        printf("Press any key to fetch the bill...");
        getch();
        system("cls");
        bill_calculator(a,count,b,q);
        tab:
        printf("Do you wish to order again?('Y' for yes & 'N' for no):\n");
        reply=getch();
        if(reply=='Y')
            {goto label;}
        else if(reply=='N'){
            printf("Its been a pleasure to serve you.\nYour Token Number is: %d\n\n\t\tPress any Key to continue...",token);
            getch();
            f=fopen("Roll.txt","a");
            fprintf(f,"\n");
            fclose(f);
                f=fopen("token.txt","w");
    ch=token+1;
    fprintf(f,"%d",ch);
    fclose(f);
            system("cls");
           // goto cabel;
    }
    else{printf("Enter a valid input.");
    getch();
    goto tab;}
    }
    else{printf("Enter a valid input.");
    getch();
    goto label;}

    int k , l;
 char answer;

 customers :
 printf(" \n ENTER THE NUMBER OF PERSONS : ");
 scanf("%d",&k);

   if(k>=1 && k<=10)
    {
        goto tableno ;
    }
    else if(k<1)
    {
        printf("     \n  INVALID \a !! Enter proper input .  \n ");
        goto customers;

    }
    else
    {
        printf(" SORRY SIR , WE DON'T HAVE MORE THAN 10 SEATS \n\n");
        printf(" WILL YOU LIKE TO CHANGE THE NUMBER OF SEATS ?? \n\n IF YES THEN ENTER 'Y' and 'N' FOR N : \n");

         answer = getch();
        if(answer=='Y'||answer=='y')
        {
            goto customers;
        }
        else if(answer=='N'||answer=='n')
        {
            printf(" SORRY ! WE  DONT HAVE MORE SEATS %c \n\n\n",1);
            goto execute;
        }

    }

   tableno:
   for(i=0;i<10;i++)
  {

     if((i+1)==k)
    {
        srand(time(0));
         l = rand()%10+((k-1)*10 + 1);
         time_slot();
    }
 }
  printf(" \n You may proceed to table number : %d \n\n\n", l );





      execute :
      printf(" \n\n \t \t \t VISIT AGAIN !! \t \t \n\n ");

}

